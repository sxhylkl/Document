# MYSQL优化
> 空间换时间、时间换空间

## 一、表的优化
1. 定长和变长字段相分离    
    - 如果每个字段的字节数是固定的，每一行的字节数就是固定的，如果想查第n行，跳过前n行的字节数即可，因此查询速度会快很多。
    - varchar、text、blob等这种变长字段，适合单独存储为一张表，用主键与核心表关联
2. 常用字段和不常用字段分离
    - 结合业务分析字段的查询场景，查询频率低的字段单独拆分出来
3. 在需要关联统计的字段上添加冗余字段
4. 列选择原则
    - 字段类型优先级：整型 > date、time > enum、char > varchar > blob、text
    
    列的特点：
    - 整型：没有国家、地区之分，没有字符集的差异
    ```sh
    比如：tinyint 1、2、3、4、5 和 char(1) a、b、c、d、e
    空间上都占1个字节，但是order by排序前者快，原因是后者需要考虑字符集和校队集(默认是排序规则)
    ```
    - time:定长，运算快，节省时间，考虑时区写SQL不方便，where >= '2005-10-12'，建议用时间戳存储(int unsgined not null)
    - enum:能起到约束值的目的，内部用整型来存储，但与char联查时，内部需要经历字符串与值的转化
    - char：定长，需要考虑字符集和排序校对集
    - varchar：不定长，要考虑字符集的转换和排序时的校对集，速度慢
    - text、blob：无法使用内存临时表（排序等操作只能在磁盘上进行）
    

5. 索引优化
    - 查询频繁
    - 区分度高
    - 长度小
    - 尽量覆盖常用查询字段
    - 索引顺序
    - 可以通过(区分度/长度)获取一个平衡值

